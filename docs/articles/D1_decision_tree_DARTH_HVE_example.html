<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>D1 Decision Tree Herpes Virus Encephalopathy • gmod</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="D1 Decision Tree Herpes Virus Encephalopathy">
<meta property="og:description" content="gmod">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/D0_getting_started_decision_models.html">D0 getting started with decision models using gmod</a>
    </li>
    <li>
      <a href="../articles/D1_decision_tree_DARTH_HVE_example.html">D1 Decision Tree Herpes Virus Encephalopathy</a>
    </li>
    <li>
      <a href="../articles/D2_gmod_decision_tree.html">D2 Introduction to Decision Trees</a>
    </li>
    <li>
      <a href="../articles/D3_dec_tree_Doubilet_1985_example.html">D3 Herpes Simplex Decision Tree Example Doubilet 1985</a>
    </li>
    <li>
      <a href="../articles/M0_getting_started_markov_gmod.html">M0 gmod: getting started with building Markov models</a>
    </li>
    <li>
      <a href="../articles/M1_gmod_intro_markov_tutorial.html">M1 Introduction to Markov modeling</a>
    </li>
    <li>
      <a href="../articles/M2_gmod_advanced_markov_tutorial.html">M2 Advanced Markov Tutorial for Time Dependent Markov Model</a>
    </li>
    <li>
      <a href="../articles/M3_Markov_age_dep.html">M3 Markov Tutorial Age Dependent</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.dashlab.ca/projects/decision_twig/" class="external-link">DecisionTwig</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hjalal/gmod" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>D1 Decision Tree Herpes Virus
Encephalopathy</h1>
            
      
      
      <div class="hidden name"><code>D1_decision_tree_DARTH_HVE_example.Rmd</code></div>

    </div>

    
    
<p>This is an example that we use to illustrate decision trees in our
DARTH teaching materials. The example involves the treatment of herpes
simplex ecncephalopathy (HVE) by either treating everyone without biopsy
(Treat), not treating or taking biopsy (DoNotTreat), and Taking biopsy
and treat if biopsy posivite (Biopsy).</p>
<p>We will first define the gmod model and the parameters and then we
will show how one would code the model direclty in R and compare the
outcomes.</p>
<div class="section level2">
<h2 id="gmod">GMOD<a class="anchor" aria-label="anchor" href="#gmod"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gmod</span><span class="op">)</span></span>
<span><span class="co">#&gt; To get started with GMOD, please check the vignettes by typing browseVignettes(package = "gmod").</span></span></code></pre></div>
<p>gmod model definition p_comp() takes in two arguments, one is the
special keyword decision, and the other is a custom one. This is a good
example that custom arguments and values can be passed to define
functions for the event_mapping and the payoffs. Thus, the return values
can be a function of these arguments and it can reduce the amount of
typing required if one choses to define multiple functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mygmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gmod.html">gmod</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/decisions.html">decisions</a></span><span class="op">(</span><span class="st">"DoNotTreat"</span>, <span class="st">"Treat"</span>, <span class="st">"Biopsy"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co">#final_outcomes("Death", "HVE_comp", "no_HVE_comp", "OVE_comp", "no_OVE_comp") +</span></span>
<span>  <span class="co">#events("DIE", "HVE","get_comp") + </span></span>
<span>  <span class="fu"><a href="../reference/event.html">event</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"DIE"</span>,  </span>
<span>            scenarios <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span>, </span>
<span>            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">pDie</span><span class="op">(</span><span class="va">decision</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span>, </span>
<span>            outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Death"</span>, <span class="st">"HVE_event"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/event.html">event</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"HVE_event"</span>,  </span>
<span>            scenarios <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span>, </span>
<span>            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_HVE</span>, <span class="cn">Inf</span><span class="op">)</span>, </span>
<span>            outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"get_HVE_comp"</span>, <span class="st">"get_OVE_comp"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/event.html">event</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"get_HVE_comp"</span>, </span>
<span>            scenarios <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span>,</span>
<span>            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">p_comp</span><span class="op">(</span><span class="va">decision</span>, HVE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>            outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HVE_comp"</span>, <span class="st">"no_HVE_comp"</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/event.html">event</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"get_OVE_comp"</span>, </span>
<span>            scenarios <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span>,</span>
<span>            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">p_comp</span><span class="op">(</span><span class="va">decision</span>, HVE <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>            outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OVE_comp"</span>, <span class="st">"no_OVE_comp"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co">#payoffs(cost = cost(decision, final_outcome, prop_with_event("HVE"=TRUE, decision)), </span></span>
<span>  <span class="fu"><a href="../reference/payoffs.html">payoffs</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fu">cost</span><span class="op">(</span><span class="va">decision</span>, <span class="va">final_outcome</span><span class="op">)</span>,  </span>
<span>          effectiveness <span class="op">=</span> <span class="fu">effectiveness</span><span class="op">(</span><span class="va">decision</span>, <span class="va">final_outcome</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Define the model parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v_names_str</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No Tx"</span>, <span class="st">"Tx All"</span>, <span class="st">"Biopsy"</span><span class="op">)</span>  <span class="co"># names of strategies</span></span>
<span><span class="va">n_str</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v_names_str</span><span class="op">)</span>             <span class="co"># number of strategies</span></span>
<span><span class="va">wtp</span>            <span class="op">&lt;-</span> <span class="fl">100000</span>                          <span class="co"># willingness to pay threshold</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        wtp            <span class="op">=</span> <span class="fl">100000</span> ,                         <span class="co"># willingness to pay threshold</span></span>
<span></span>
<span>        <span class="co"># Probabilities,</span></span>
<span>        p_HVE          <span class="op">=</span> <span class="fl">0.52</span>   ,<span class="co"># prevalence of HVE</span></span>
<span>        p_HVE_comp     <span class="op">=</span> <span class="fl">0.71</span>   ,<span class="co"># complications with untreated HVE</span></span>
<span>        p_OVE_comp     <span class="op">=</span> <span class="fl">0.01</span>   ,<span class="co"># complications with untreated OVE</span></span>
<span>        p_HVE_comp_tx  <span class="op">=</span> <span class="fl">0.36</span>   ,<span class="co"># complications with treated HVE</span></span>
<span>        p_OVE_comp_tx  <span class="op">=</span> <span class="fl">0.20</span>   ,<span class="co"># complications with treated OVE</span></span>
<span>        p_biopsy_death <span class="op">=</span> <span class="fl">0.005</span>  ,<span class="co"># probability of death due to biopsy</span></span>
<span></span>
<span>        <span class="co"># Costs,</span></span>
<span>        c_VE           <span class="op">=</span> <span class="fl">1200</span>   ,<span class="co"># cost of viral encephalitis care without complications</span></span>
<span>        c_VE_comp      <span class="op">=</span> <span class="fl">9000</span>   ,<span class="co"># cost of viral encephalitis care with complications</span></span>
<span>        c_tx           <span class="op">=</span> <span class="fl">9500</span>   ,<span class="co"># cost of treatment</span></span>
<span>        c_biopsy       <span class="op">=</span> <span class="fl">25000</span>  ,<span class="co"># cost of brain biopsy</span></span>
<span></span>
<span>        <span class="co"># QALYs,</span></span>
<span>        q_VE           <span class="op">=</span> <span class="fl">20</span>     ,<span class="co"># remaining QALYs for those without VE-related complications</span></span>
<span>        q_VE_comp      <span class="op">=</span> <span class="fl">19</span>     ,<span class="co"># remaining QALYs for those with VE-related complications</span></span>
<span>        q_loss_biopsy  <span class="op">=</span> <span class="fl">0.01</span>   ,<span class="co"># one-time QALY loss due to brain biopsy</span></span>
<span>        q_death_biopsy <span class="op">=</span> <span class="fl">0</span>      <span class="co"># remaining QALYs for those who died during biopsy</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>define custom user functions</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pDie</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">decision</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"Biopsy"</span><span class="op">)</span> <span class="va">p_biopsy_death</span> <span class="kw">else</span> <span class="fl">0</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">p_comp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">decision</span>, <span class="va">HVE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"DoNotTreat"</span> <span class="op">&amp;</span> <span class="va">HVE</span> <span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p_HVE_comp</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"DoNotTreat"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">HVE</span> <span class="op">)</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p_OVE_comp</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"Treat"</span> <span class="op">&amp;</span> <span class="va">HVE</span> <span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p_HVE_comp_tx</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"Treat"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">HVE</span> <span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p_OVE_comp_tx</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"Biopsy"</span> <span class="op">&amp;</span> <span class="va">HVE</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p_HVE_comp_tx</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"Biopsy"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">HVE</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p_OVE_comp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">c_HVE</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">decision</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"biopsy"</span><span class="op">)</span> <span class="va">c_tx</span> <span class="kw">else</span> <span class="fl">0</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">cost</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">decision</span>, <span class="va">final_outcome</span><span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="va">c_biopsy</span><span class="op">*</span><span class="op">(</span><span class="va">decision</span><span class="op">==</span><span class="st">"Biopsy"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="va">c_tx</span><span class="op">*</span><span class="op">(</span><span class="va">decision</span><span class="op">==</span><span class="st">"Treat"</span> <span class="op">|</span> <span class="op">(</span><span class="va">decision</span><span class="op">==</span><span class="st">"Biopsy"</span> <span class="op">&amp;</span> <span class="va">final_outcome</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HVE_comp"</span>, <span class="st">"no_HVE_comp"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="va">c_VE_comp</span><span class="op">*</span><span class="op">(</span><span class="va">final_outcome</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HVE_comp"</span>, <span class="st">"OVE_comp"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="va">c_VE</span><span class="op">*</span><span class="op">(</span><span class="va">final_outcome</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no_HVE_comp"</span>, <span class="st">"no_OVE_comp"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">effectiveness</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">decision</span>, <span class="va">final_outcome</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="op">-</span><span class="va">q_loss_biopsy</span><span class="op">*</span><span class="op">(</span><span class="va">decision</span><span class="op">==</span><span class="st">"Biopsy"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="va">q_VE_comp</span><span class="op">*</span><span class="op">(</span><span class="va">final_outcome</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HVE_comp"</span>, <span class="st">"OVE_comp"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="va">q_VE</span><span class="op">*</span><span class="op">(</span><span class="va">final_outcome</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no_HVE_comp"</span>, <span class="st">"no_OVE_comp"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>testing some of the functions outside of the model</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#p_comp(decision = "Biopsy", HVE = FALSE)</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#cost("Biopsy", "HVE_comp")</span></span>
<span><span class="co">#effectiveness("Biopsy", "Death")</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_struc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gmod_build.html">gmod_build</a></span><span class="op">(</span><span class="va">mygmod</span><span class="op">)</span></span>
<span><span class="va">model_struc</span></span>
<span><span class="co">#&gt; $decisions</span></span>
<span><span class="co">#&gt; [1] "DoNotTreat" "Treat"      "Biopsy"    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_decisions</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_events</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $final_outcomes</span></span>
<span><span class="co">#&gt; [1] "Death"       "HVE_comp"    "no_HVE_comp" "OVE_comp"    "no_OVE_comp"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_final_outcomes</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $events</span></span>
<span><span class="co">#&gt; [1] "DIE"          "HVE_event"    "get_HVE_comp" "get_OVE_comp"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $payoffs</span></span>
<span><span class="co">#&gt; $payoffs$cost</span></span>
<span><span class="co">#&gt; cost(decision, final_outcome)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $payoffs$effectiveness</span></span>
<span><span class="co">#&gt; effectiveness(decision, final_outcome)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $payoff_names</span></span>
<span><span class="co">#&gt; [1] "cost"          "effectiveness"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_payoffs</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $final_outcome_formulae</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 10</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   decision, final_outcome [15]</span></span></span>
<span><span class="co">#&gt;    decision   final_outcome path_id probs           DIE   HVE_event get_HVE_comp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Biopsy     Death               1 (pDie('Biopsy'… TRUE  FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Biopsy     HVE_comp            2 (1-(pDie('Biop… FALSE TRUE      TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Biopsy     OVE_comp            4 (1-(pDie('Biop… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Biopsy     no_HVE_comp         3 (1-(pDie('Biop… FALSE TRUE      FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Biopsy     no_OVE_comp         5 (1-(pDie('Biop… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> DoNotTreat Death               1 (pDie('DoNotTr… TRUE  FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> DoNotTreat HVE_comp            2 (1-(pDie('DoNo… FALSE TRUE      TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> DoNotTreat OVE_comp            4 (1-(pDie('DoNo… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> DoNotTreat no_HVE_comp         3 (1-(pDie('DoNo… FALSE TRUE      FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DoNotTreat no_OVE_comp         5 (1-(pDie('DoNo… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Treat      Death               1 (pDie('Treat')) TRUE  FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Treat      HVE_comp            2 (1-(pDie('Trea… FALSE TRUE      TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Treat      OVE_comp            4 (1-(pDie('Trea… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> Treat      no_HVE_comp         3 (1-(pDie('Trea… FALSE TRUE      FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> Treat      no_OVE_comp         5 (1-(pDie('Trea… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: get_OVE_comp &lt;chr&gt;, cost &lt;chr&gt;, effectiveness &lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $summary_formulae</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   decision   cost                                                  effectiveness</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Biopsy     (pDie('Biopsy'))*cost('Biopsy', 'Death')+(1-(pDie('B… (pDie('Biops…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DoNotTreat (pDie('DoNotTreat'))*cost('DoNotTreat', 'Death')+(1-… (pDie('DoNot…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Treat      (pDie('Treat'))*cost('Treat', 'Death')+(1-(pDie('Tre… (pDie('Treat…</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "gmod_decision"</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gmod_gen_model_function.html">gmod_gen_model_function</a></span><span class="op">(</span><span class="va">model_struc</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in gmod_gen_model_function.gmod_decision(model_struc): Model function my_decision_model is generated. It can be run by calling it directly:</span></span>
<span><span class="co">#&gt; my_decision_model(params)</span></span>
<span><span class="va">model_res</span></span>
<span><span class="co">#&gt; $decisions</span></span>
<span><span class="co">#&gt; [1] "DoNotTreat" "Treat"      "Biopsy"    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_decisions</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_events</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $final_outcomes</span></span>
<span><span class="co">#&gt; [1] "Death"       "HVE_comp"    "no_HVE_comp" "OVE_comp"    "no_OVE_comp"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_final_outcomes</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $events</span></span>
<span><span class="co">#&gt; [1] "DIE"          "HVE_event"    "get_HVE_comp" "get_OVE_comp"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $payoffs</span></span>
<span><span class="co">#&gt; $payoffs$cost</span></span>
<span><span class="co">#&gt; cost(decision, final_outcome)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $payoffs$effectiveness</span></span>
<span><span class="co">#&gt; effectiveness(decision, final_outcome)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $payoff_names</span></span>
<span><span class="co">#&gt; [1] "cost"          "effectiveness"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_payoffs</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $final_outcome_formulae</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 10</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   decision, final_outcome [15]</span></span></span>
<span><span class="co">#&gt;    decision   final_outcome path_id probs           DIE   HVE_event get_HVE_comp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Biopsy     Death               1 (pDie('Biopsy'… TRUE  FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Biopsy     HVE_comp            2 (1-(pDie('Biop… FALSE TRUE      TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Biopsy     OVE_comp            4 (1-(pDie('Biop… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Biopsy     no_HVE_comp         3 (1-(pDie('Biop… FALSE TRUE      FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Biopsy     no_OVE_comp         5 (1-(pDie('Biop… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> DoNotTreat Death               1 (pDie('DoNotTr… TRUE  FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> DoNotTreat HVE_comp            2 (1-(pDie('DoNo… FALSE TRUE      TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> DoNotTreat OVE_comp            4 (1-(pDie('DoNo… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> DoNotTreat no_HVE_comp         3 (1-(pDie('DoNo… FALSE TRUE      FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DoNotTreat no_OVE_comp         5 (1-(pDie('DoNo… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Treat      Death               1 (pDie('Treat')) TRUE  FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Treat      HVE_comp            2 (1-(pDie('Trea… FALSE TRUE      TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Treat      OVE_comp            4 (1-(pDie('Trea… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> Treat      no_HVE_comp         3 (1-(pDie('Trea… FALSE TRUE      FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> Treat      no_OVE_comp         5 (1-(pDie('Trea… FALSE FALSE     FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: get_OVE_comp &lt;chr&gt;, cost &lt;chr&gt;, effectiveness &lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $summary_formulae</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   decision   cost                                                  effectiveness</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Biopsy     (pDie('Biopsy'))*cost('Biopsy', 'Death')+(1-(pDie('B… (pDie('Biops…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DoNotTreat (pDie('DoNotTreat'))*cost('DoNotTreat', 'Death')+(1-… (pDie('DoNot…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Treat      (pDie('Treat'))*cost('Treat', 'Death')+(1-(pDie('Tre… (pDie('Treat…</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "gmod_decision"</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">my_decision_model</span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span>
<span><span class="co">#&gt;                cost effectiveness</span></span>
<span><span class="co">#&gt; Biopsy     32599.41      19.69896</span></span>
<span><span class="co">#&gt; DoNotTreat  4117.20      19.62600</span></span>
<span><span class="co">#&gt; Treat      12908.96      19.71680</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="direct-coding-in-r">Direct coding in R<a class="anchor" aria-label="anchor" href="#direct-coding-in-r"></a>
</h2>
<p>And here is what the code looks like if one wants to code the
transitions all in R directly without using gmod</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create vector of weights for each strategy </span></span>
<span>  </span>
<span><span class="va">v_w_no_tx</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="va">p_HVE</span>  <span class="op">*</span>      <span class="va">p_HVE_comp</span>     ,  <span class="co"># HVE, complications</span></span>
<span>                    <span class="va">p_HVE</span>  <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_HVE_comp</span><span class="op">)</span>    ,  <span class="co"># HVE, no complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_HVE</span><span class="op">)</span> <span class="op">*</span>      <span class="va">p_OVE_comp</span>     ,  <span class="co"># OVE, complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_HVE</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_OVE_comp</span><span class="op">)</span><span class="op">)</span>      <span class="co"># OVE, no complications</span></span>
<span>  </span>
<span><span class="va">v_w_tx</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="va">p_HVE</span>  <span class="op">*</span>      <span class="va">p_HVE_comp_tx</span>  ,  <span class="co"># HVE w/tx, complications</span></span>
<span>                    <span class="va">p_HVE</span>  <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_HVE_comp_tx</span><span class="op">)</span> ,  <span class="co"># HVE w/tx, no complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_HVE</span><span class="op">)</span> <span class="op">*</span>      <span class="va">p_OVE_comp_tx</span>  ,  <span class="co"># OVE w/tx, complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_HVE</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_OVE_comp_tx</span><span class="op">)</span><span class="op">)</span>   <span class="co"># OVE w/tx, no complications</span></span>
<span>  </span>
<span><span class="va">v_w_biopsy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_biopsy_death</span>                   ,  <span class="co"># biopsy death</span></span>
<span>               <span class="co"># no biopsy death.,   HVE w/tx,        complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_biopsy_death</span><span class="op">)</span>   <span class="op">*</span>    <span class="va">p_HVE</span>  <span class="op">*</span>    <span class="va">p_HVE_comp_tx</span>  ,  </span>
<span>               <span class="co"># no biopsy death.,   HVE w/tx,     no complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_biopsy_death</span><span class="op">)</span>   <span class="op">*</span>    <span class="va">p_HVE</span>  <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_HVE_comp_tx</span><span class="op">)</span> ,  </span>
<span>               <span class="co"># no biopsy death.,        OVE,        complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_biopsy_death</span><span class="op">)</span>   <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_HVE</span><span class="op">)</span> <span class="op">*</span>      <span class="va">p_OVE_comp</span>   ,  </span>
<span>               <span class="co"># no biopsy death.,        OVE,     no complications</span></span>
<span>               <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_biopsy_death</span><span class="op">)</span>   <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_HVE</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_OVE_comp</span><span class="op">)</span><span class="op">)</span>      </span>
<span>  </span>
<span><span class="co"># Create vector of final_outcomes (QALYs) for each strategy </span></span>
<span>  </span>
<span><span class="va">v_qaly_no_tx</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">q_VE_comp</span> ,          <span class="co"># HVE, complications</span></span>
<span>                   <span class="va">q_VE</span>      ,          <span class="co"># HVE, no complications</span></span>
<span>                   <span class="va">q_VE_comp</span> ,          <span class="co"># OVE, complications</span></span>
<span>                   <span class="va">q_VE</span><span class="op">)</span>                <span class="co"># OVE, no complications</span></span>
<span>  </span>
<span><span class="va">v_qaly_tx</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">q_VE_comp</span> ,          <span class="co"># HVE, complications</span></span>
<span>                   <span class="va">q_VE</span>      ,          <span class="co"># HVE, no complications</span></span>
<span>                   <span class="va">q_VE_comp</span> ,          <span class="co"># OVE, complications</span></span>
<span>                   <span class="va">q_VE</span><span class="op">)</span>                <span class="co"># OVE, no complications</span></span>
<span>  </span>
<span>  </span>
<span><span class="va">v_qaly_biopsy</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">q_loss_biopsy</span>     <span class="op">+</span>   <span class="co"># loss due to biopsy</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">q_death_biopsy</span>  ,   <span class="co"># biopsy complications</span></span>
<span>                    <span class="va">q_VE_comp</span>       ,   <span class="co"># no biopsy comp., HVE w/tx, complications </span></span>
<span>                    <span class="va">q_VE</span>            ,   <span class="co"># no biopsy comp., HVE w/tx, no complications</span></span>
<span>                    <span class="va">q_VE_comp</span>       ,   <span class="co"># no biopsy comp., OVE, complications</span></span>
<span>                    <span class="va">q_VE</span><span class="op">)</span>               <span class="co"># no biopsy comp., OVE, no complications</span></span>
<span>  </span>
<span><span class="co"># Create vector of costs for each strategy </span></span>
<span>  </span>
<span><span class="va">v_cost_no_tx</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">c_VE_comp</span> ,          <span class="co"># HVE, complications</span></span>
<span>                   <span class="va">c_VE</span>      ,          <span class="co"># HVE, no complications</span></span>
<span>                   <span class="va">c_VE_comp</span> ,          <span class="co"># OVE, complications</span></span>
<span>                   <span class="va">c_VE</span><span class="op">)</span>                <span class="co"># OVE, no complications</span></span>
<span>  </span>
<span><span class="va">v_cost_tx</span>     <span class="op">&lt;-</span> <span class="va">c_tx</span> <span class="op">+</span>                 <span class="co"># cost of treatment</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">c_VE_comp</span> ,          <span class="co"># HVE, complications</span></span>
<span>                   <span class="va">c_VE</span>      ,          <span class="co"># HVE, no complications</span></span>
<span>                   <span class="va">c_VE_comp</span> ,          <span class="co"># OVE, complications</span></span>
<span>                   <span class="va">c_VE</span><span class="op">)</span>                <span class="co"># OVE, no complications</span></span>
<span>  </span>
<span><span class="va">v_cost_biopsy</span> <span class="op">&lt;-</span> <span class="va">c_biopsy</span>           <span class="op">+</span>   <span class="co"># cost of biopsy procedure</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>                ,   <span class="co"># cost of death (zero)</span></span>
<span>                   <span class="va">c_VE_comp</span> <span class="op">+</span> <span class="va">c_tx</span> ,   <span class="co"># no biopsy comp., HVE w/tx, complications </span></span>
<span>                   <span class="va">c_VE</span> <span class="op">+</span> <span class="va">c_tx</span>      ,   <span class="co"># no biopsy comp., HVE w/tx, no complications</span></span>
<span>                   <span class="va">c_VE_comp</span>        ,   <span class="co"># no biopsy comp., OVE, complications</span></span>
<span>                   <span class="va">c_VE</span><span class="op">)</span>                <span class="co"># no biopsy comp., OVE, no complications</span></span>
<span> </span>
<span><span class="co"># Calculate total utilities for each strategy </span></span>
<span><span class="va">total_qaly_no_tx</span>  <span class="op">&lt;-</span> <span class="va">v_w_no_tx</span>  <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="va">v_qaly_no_tx</span>      </span>
<span><span class="va">total_qaly_tx</span>     <span class="op">&lt;-</span> <span class="va">v_w_tx</span>     <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="va">v_qaly_tx</span></span>
<span><span class="va">total_qaly_biopsy</span> <span class="op">&lt;-</span> <span class="va">v_w_biopsy</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="va">v_qaly_biopsy</span></span>
<span>  </span>
<span><span class="co"># Calculate total costs for each strategy </span></span>
<span><span class="va">total_cost_no_tx</span>  <span class="op">&lt;-</span> <span class="va">v_w_no_tx</span>  <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="va">v_cost_no_tx</span>    </span>
<span><span class="va">total_cost_tx</span>     <span class="op">&lt;-</span> <span class="va">v_w_tx</span>     <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="va">v_cost_tx</span></span>
<span><span class="va">total_cost_biopsy</span> <span class="op">&lt;-</span> <span class="va">v_w_biopsy</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="va">v_cost_biopsy</span></span>
<span>  </span>
<span><span class="co"># vector of total QALYs</span></span>
<span><span class="va">v_total_qaly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">total_qaly_no_tx</span>, <span class="va">total_qaly_tx</span>, <span class="va">total_qaly_biopsy</span><span class="op">)</span> </span>
<span><span class="co"># vector of total costs</span></span>
<span><span class="va">v_total_cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">total_cost_no_tx</span>, <span class="va">total_cost_tx</span>, <span class="va">total_cost_biopsy</span><span class="op">)</span> </span>
<span><span class="co"># calculate vector of nmb</span></span>
<span><span class="va">v_nmb</span>        <span class="op">&lt;-</span> <span class="va">v_total_qaly</span> <span class="op">*</span> <span class="va">wtp</span> <span class="op">-</span> <span class="va">v_total_cost</span>                      </span>
<span>  </span>
<span><span class="co"># Name final_outcomes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">v_total_qaly</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">v_names_str</span>  <span class="co"># names for the elements of the total QALYs vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">v_total_cost</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">v_names_str</span>  <span class="co"># names for the elements of the total cost vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">v_nmb</span><span class="op">)</span>        <span class="op">&lt;-</span> <span class="va">v_names_str</span>  <span class="co"># names for the elements of the nmb vector</span></span>
<span>  </span>
<span><span class="va">df_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Strategy <span class="op">=</span>  <span class="va">v_names_str</span>,</span>
<span>                        Cost     <span class="op">=</span>  <span class="va">v_total_cost</span>,</span>
<span>                        Effect   <span class="op">=</span>  <span class="va">v_total_qaly</span>,</span>
<span>                        NMB      <span class="op">=</span>  <span class="va">v_nmb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># model output</span></span>
<span><span class="va">df_output</span></span>
<span><span class="co">#&gt;        Strategy     Cost   Effect     NMB</span></span>
<span><span class="co">#&gt; No Tx     No Tx  4117.20 19.62600 1958483</span></span>
<span><span class="co">#&gt; Tx All   Tx All 12908.96 19.71680 1958771</span></span>
<span><span class="co">#&gt; Biopsy   Biopsy 32599.41 19.69896 1937297</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.dashlab.ca" class="external-link">Hawre Jalal</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
